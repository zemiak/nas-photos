#/bin/sh

export JAVA_HOME=${JAVA_HOME:-/Library/Java/JavaVirtualMachines/jdk1.8.0_40.jdk/Contents/Home/}
mvn -q clean || exit 1
#mvn -q integration-test || exit 2
mvn -q package  || exit 3
if [ $? -eq 0 ]
then
    cp ./target/nasphotos.war ../docker/containers/nasphotos/
    cd ../docker/containers/nasphotos
    docker stop nasphotos
    docker rm nasphotos
    docker build -t nasphotos . && sh run-local.sh
    cd ../../../nasphotos
    echo Deployed.
fi
